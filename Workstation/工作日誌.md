1.整理TCMS程式清單
2.工時統分
3.帳密留給我

帳號
Z215
密碼
!@#$QWERASDFZXCV

## 2015-07-31 (FRI)
## 2015-07-30 (THU)

- server: tcmsbat1
- B2ED010  (0729)
  新增查詢條件(TC_FORM_CD)，要放置在SITA CODE之前

- B2ER050
  修改查詢條件，  
	1. 部門改為預設帶空值 (空值代表查詢全部)
	2. 年月改為日期區間

http://www.tek-tips.com/viewthread.cfm?qid=1661164

- B2ER060
  修改查詢條件，  
	1. 部門改為預設帶空值 (空值代表查詢全部)


	2. 年月改為日期區間

- BASR010  
  修改查詢SQL，需要增加以下查詢邏輯
```
```

- 增加功能頁(PURR030)，叫做採購金額統計報表　　
　　參考PURR020，查詢邏輯如下，
```
``` 
  修改查詢SQL，需要增加以下查詢邏輯

## 2015-07-29 (WED)
- 處理 SMAS (qaunismasap01.uniair.com.tw) PURD011 修改完資料後，存檔發生 SEQ　undefined的問題(P3107M0963 搞的鬼)

## 2015-07-21 (TUE)
- 處理 TCMS 圖檔上傳 & SYNC 的問題
- 檔案清單
	* C:\Inetpub\wwwroot\TCMS\BASD012 (grant full access to IIS_USER)
	* B2EM012.ASPX.VB
	* B2EM011.JS
	* C:\Inetpub\wwwroot\TCMS_Service\TCMSBL.vb(1753)
	* C:\Inetpub\wwwroot\TCMS_Trans\TCMSBL.vb(1587): 

## 2015-07-20 (MON)
- 處理 TCMS 
 
## 2015-07-17 (FRI)
- 處理 TCMS B2EM011.js fortify 問題 (open dialog)

## 2015-07-16 (THU)
- TCSM SYSTEM PURD011, PURD013 問題
/*
  <system.web>
    <trace enabled="true" pageOutput="false" requestLimit="40" localOnly="false"/>
*/
    
--------------------
-- 查詢 PURD13
--------------------
SELECT * FROM PUR_REQUEST_MASTER WHERE RQST_NBR IN (SELECT 'M150000' || SERIAL_SEQ FROM INV_TRANSACTION_SEQUENCE WHERE TXN_TYP_CD='M' AND TXN_YR= '15');

SELECT * FROM PUR_REQUEST_DETAILS WHERE RQST_NBR IN (SELECT 'M150000' || SERIAL_SEQ FROM INV_TRANSACTION_SEQUENCE WHERE TXN_TYP_CD='M' AND TXN_YR= '15');


--------------------
-- 查詢 PURD11
--------------------
-- # 154

SELECT A.TC_FORM_CD,
       NVL (A.EST_DLVR_DT, ' ') EST_DLVR_DT,
       NVL (A.RQST_QTY, '0') RQST_QTY,
       '' STORE_NBR,
       A.VNDR_NBR,
       NVL (A.PUR_NBR, ' ') PUR_NBR,
       A.PROC_STUS_CD,
       A.RQST_COEF_RATE,
       A.UPD_EMP_ID,
       A.UPD_DT,
       A.UPD_TM,
       D.SUPP_MIN_QTY,
       '' LT_MARK,
       B.CLS_LVL_CD,
       B.TC_FORM_ENG_NM,
       B.LEAD_TM_DAYS_MSR,
       A.SUPP_UNIT_CD,
       B.VNDR_NBR VNDR_NBR1
  FROM PUR_REQUEST_DETAILS A,
       BAS_MATERIAL B,
       BAS_MATERIAL_CLASS C,
       VND_SUPPLY D
 WHERE     A.RQST_NBR = 'M150000123'
       AND A.TC_FORM_CD = B.TC_FORM_CD
       AND A.VNDR_NBR = D.VNDR_NBR
       AND B.TC_FORM_CD = D.TC_FORM_CD
       AND A.PROC_STUS_CD <> '0'
       AND A.PROC_STUS_CD <> 'Z'
       AND C.CLS_TYP_CD = '1' -- ISSUE
       AND B.CLS_LVL_CD = C.CLS_LVL_CD
       AND C.PROC_STUS_CD <> '0'

## 2015-07-15 (WED) 
- 新增報表 LCSR0030 - 料號使用棧板狀況一覽表
SELECT A.CODE,MAX(ENGLISH_SHORTNAME) ENGLISH_SHORTNAME,COUNT(PALLET_ID) PALLET_COUNT
FROM LCS_ITEM_WITH_PALLET A,BAS_MATERIAL B
WHERE A.CODE=B.CODE AND '1700021' <= A.CODE AND A.CODE <= '1700023' 
GROUP BY A.CODE

## 2015-07-14 (TUE) 
- 新增報表 LCSR0030 - 料號使用棧板狀況一覽表
SELECT A.CODE,MAX(ENGLISH_SHORTNAME) ENGLISH_SHORTNAME,COUNT(PALLET_ID) PALLET_COUNT
FROM LCS_ITEM_WITH_PALLET A,BAS_MATERIAL B
WHERE A.CODE=B.CODE AND '1700021' <= A.CODE AND A.CODE <= '1700023' 
GROUP BY A.CODE

## 2015-07-13 (MON)
以
E68180
登入報廢作業(
INVD0140
)報廢一般品

報廢編號：
航服品字第2015-0006號

報廢理由：
航服品字第E2015-0020號

(下面30個勾選理由都一樣)
以下為勾選的30個品項的料號  麻煩您協助處查詢了
謝謝！

0300302
0300504
0300512
0500044(X)
0800003(X)
0800054(X)
0800057(X)
0800065(X)
0800066(X)
0800067
0800068
0800069
0800070
0800071
0800084(X)
0800085(X)
0800086(X)
0800095(X)
0800107(X)
0900195(X)
0900304(X)
0900309(X)
1300703(X)
1300714(X)
1700065(X)
1700129(X)
1700130(X)
1700131(X)
1700140
1700141

## 2015-07-09 (THU)
- 處理SCS service 在正式環境無法運作的問題
- USER反應主檔管理的 中英文特色介紹，現在在key進去時發現，key完存檔成功後，再按修改進去看，剛剛key的資料又變空白。
幫我試一下你本機會這樣嗎？

## 2015-07-08 (WED)
- 修正PURR0020報表

 
## 2015-07-07 (TUE)
- 修正BASM0124 BUG
- 協助發布scs service到正式環境

## 2015-07-06 (MON)

檢查SQL查詢會發生錯誤的原因，檢查資料面有甚麼問題，並提出修正方案

	

	  SELECT TRANS_NO,
	         SHEET_NO,
	         IN_OUT,
	         A.CODE,
	         TRANS_QTY,
	         INV_QTY,
	         A.ORIGINAL_DATE,
	         ENGLISH_SHORTNAME,
	         STORE_UNIT,
	         UPPER (A.APPLY_NO) APPLY_NO,
	         IN_OUT_DATE
	    FROM (SELECT A.TRANS_NO,
	                 A.SHEET_NO SHEET_NO,
	                 IN_OUT,
	                 B.CODE CODE,
	                 B.TRANS_QTY,
	                 (SELECT CURRENT_QTY
	                    FROM CTM_CUSTOMS_BOND_STOCK
	                   WHERE STORE_NO = 'MANO' AND CODE = B.CODE)
	                    INV_QTY,
	                 A.IN_OUT_DATE,
	                 B.ORIGINAL_DATE,
	                 B.ORIGINAL_NO APPLY_NO
	            FROM CTM_CUSTOMS_TRANS_MASTER A, CTM_CUSTOMS_TRANS_DETAILS B
	           WHERE A.STORE_NO = 'MANO' AND A.IN_OUT = 'I' AND A.STATUS <> '0'
	                 AND TRUNC (SYSDATE) - TO_DATE (B.ORIGINAL_DATE, 'YYYYMMDD') >
	                        TO_NUMBER ('720')
	                 AND B.CODE >= '0'
	                 AND B.CODE <= 'zzzzzzzzzzzzzz'
	                 AND B.CODE IN
	                        (  SELECT B.CODE
	                             FROM CTM_CUSTOMS_TRANS_MASTER A,
	                                  CTM_CUSTOMS_TRANS_DETAILS B
	                            WHERE     A.STORE_NO = B.STORE_NO
	                                  AND A.SHEET_NO = B.SHEET_NO
	                                  AND B.ORIGINAL_DATE >= '20060101'
	                                  AND A.STORE_NO = 'MANO'
	                                  AND A.IN_OUT = 'I'
	                                  AND A.STATUS <> '0'
	                                  AND B.STATUS <> '0'
	                                  AND B.CODE >= '0'
	                                  AND B.CODE <= 'zzzzzzzzzzzzzz'
	                                  AND TRUNC (SYSDATE)
	                                      - TO_DATE (B.ORIGINAL_DATE, 'YYYYMMDD') >
	                                         TO_NUMBER ('720')
	                         GROUP BY B.CODE
	                           HAVING TRUNC (SYSDATE)
	                                  - TO_DATE (MAX (B.ORIGINAL_DATE), 'YYYYMMDD') >
	                                     TO_NUMBER ('720'))
	                 AND B.STATUS <> '0'
	                 AND A.STORE_NO = B.STORE_NO
	                 AND A.SHEET_NO = B.SHEET_NO
	                 AND SUBSTR (A.APPLY_NO, 3, 1) = '/') A,
	         CTM_CUSTOMS_BOND_STOCK B,
	         BAS_MATERIAL C
	   WHERE     B.STORE_NO = 'MANO'
	         AND B.CURRENT_QTY > 0
	         AND A.CODE = B.CODE
	         AND A.CODE = C.CODE
	         AND A.ORIGINAL_DATE >= '20060101'
	ORDER BY A.CODE, A.IN_OUT_DATE DESC


## 2015-07-03 (FRI)
  - 延續 2015-07-02 工作內容
  - INVD0130(轉換檔案格式錯誤)
	 * http://localhost/SMASWebAP/inv/INVD0130.aspx
	 * 操作 勾選2G 2C Transfer按轉檔
	   修正方式
       D-000000000000520000000000000000000000
       C000000000000520000000000000000000000

 

## 2015-07-02 (THU)
  - BASM0120  
	 * 新增按鈕 [清除未領用之公關單]，點選此按鈕將連結到 BASM0123 (清除未領用之公關單)
  - BASM0123
	 * 查詢條件： 申請日期(須限制輸入日期必須為半年以前的日期)
	 * 查詢結果欄位如下
		1. 核取框
		2. 申請單
		3. 申請部門
		4. 申請日
		5. 申請人(請到PSN_OPEN_DATA串)
		6. 申請電話
		7. 料號
		8. 數量
	 * 查詢邏輯如下

    	SELECT A.TRANS_NO,
    	   A.DEPARTMENT_NO,
    	   A.TRANS_DATE,
    	   A.APPLY_ID,
    	   A.APPLY_TEL,
    	   B.CODE,
    	   B.TRANS_QTY
    	  FROM INV_PUBLIC_GIFT_MASTER A, INV_PUBLIC_GIFT_DETAILS B
    	 WHERE A.TRANS_NO = B.TRANS_NO AND A.TRANS_DATE < '20150101'


	 * 當按下刪除按鈕時，須執行以下邏輯
		1. 紀錄LOG (TableName: INV_PUBLIC_GIFT_DEL_LOG)
			- INV_PUBLIC_GIFT_DEL_LOG 目前尚未建立，需手動建立此資料表，並包含以下欄位
			  	1. TRANS_NO
			  	2. DEPARTMENT_NO
			  	3. TRANS_DATE
			  	4. APPLY_ID
			  	5. APPLY_TEL
			  	6. CODE
			  	7. TRANS_QTY
			  	8. INV_INVENTORY_BEFORE_PREN_QTY
			  	9. INV_INVENTORY_AFTER_PREN_QTY
			- 更新PREN_QTY，更新邏輯如下
			  (依料號將GENL的預備出庫量PREN_QTY)-所選資料上面的數量(TRANS_QTY)
			- (依料號將GENL的預備出庫量PREN_QTY) 查詢邏輯如下

    				SELECT PREN_QTY
    				  FROM INV_INVENTORY
    				 WHERE STORE_NO = 'GENL' AND CODE = ?			
    
		2. 刪除勾選的單據對應的 INV_PUBLIC_GIFT_DETAILS
		3. 刪除勾選的單據對應的 INV_PUBLIC_GIFT_MASTER

sInnerHtml += CreaterInnerHTML("hidden", g_fh.Public_Decode(g_fh.Public_Encode("txtGIFT_FLAG" + rows)), "1", g_fh.Public_Decode(g_fh.Public_Encode(GIFT_FLAG)), false, "", "", true, "", "", "GIFT_FLAG", "");

http://localhost/SMASWebAP/PUR/PURD0024.aspx

## 2015-07-01 (WED)

  - 修改專案的FORTIFY問題
  - 以下為修改程式清單
	 * C:\inetpub\wwwroot\SMAS.MainWebAP\SMAS.MainWebAP\Query
	 * ServiceMonitor

## 2015-06-30 (TUE)

  - AUTD0080.JS 回復成舊有的程式碼
  - AUTD0080.JS #395 本機連接 http://SMASAP/SMASWebAP/VND/VNDD0057.aspx
  - 修復在 IE 中，執行 BlockUI.js 的 GetTitle() 拋出錯誤的問題
  
## 2015-06-29 (MON)

  - (解決 Fortify 的問題) EAMS.MainWebAP
    C:\Users\Z215\Desktop\EAMS.MainWebAP
    C:\Backup\20150626\(解決 Fortify 的問題) EAMS.MainWebAP
	* EAMS.MainWebAP
		- CommonQuery.aspx.cs
	* EAMS.MainWebAP.AUT
	* EAMS.MainWebAP.BAS
	* EAMS.MainWebAP.PSD
	* SMAS.Cryptography
	* SMAS.CustomComponent
	* SMAS.CustomHandlers
	* SMAS.CustomSecurity
	* DDSC.CustomServerControl
	* DDSC.OracleADO
	* 
	* Logic
	* ReportService
	* 
## 2015-06-26 (FRI)
  - (解決 Fortify 的問題) SMAS_PDA_WS 
    將結果寄信到 STANHUANG@EVAAIR.COM (file://stanhuang@evaair.com/)

## 2015-06-25 (THU)
  - (TCSM) 延續 2015-06-22 的問題，偵錯在(OMD PIC)呈核完成後，為什麼單據沒有跑到系統管理者身上
  - (TCSM) 寄信給 B2ED0032 (製作運補計畫) 按下存檔，請加入寄信給申請者的動作，以下為信件內容範例
	* 以帳號 361027 登入，http://localhost:60273/TCMS/B2E/B2ED030.aspx
	* 查詢條件 運補日期= 20150116 ~ 20150116 ，狀態= 已轉分站運補計
	* 勾選三筆，按 轉運補計劃
	* 將進入B2ED032
	* 直接存檔，請加入寄信給申請者的動作，以下為信件內容範例
	* 	主旨：申請單號-A15XXXXX，已由20150117，BR0036運補！
	* 	內容：Dear Sir, 申請單號-A15XXXXX，已由20150117，BR0036運補，請記得簽收！
  - (TCSM) 修改檔案清單
	* B2ED011.aspx.vb
	* B2ED032.aspx.vb
	* Utility.vb 
  - 告知郁馨
	* (TCSM)  測試完成請刪除  
	  strEmail = "belindashao@evaair.com" ' 這是測試用，未來請刪除

	* (TCSM) 目前發送EMAIL的來源預設為belindashao@evaair.com，若要修改，請查詢以下內容
	  Const mailFrom As String = "belindashao@evaair.com"

	* (SMAS) SCRR0160
	* 來源預設為SCR_RPT_TMP_1，並非SCR_RPT_TMP，請在PRODUCTION環境建立相同TABLE

## 2015-06-24 (WED)
  - 處理B2CM0031.js (Fortify)

## 2015-06-23 (TUE)
  - 修正 ReportLogic_OUT.OUTR0050 計算報表錯誤
  - TCMS(AUTD070)，場站主管審核後，若申請資料遭OMD PIC或系統管理人修改，由系統傳送異動通知(email)給申請人
	* 測試 OMD PIC  ： B82420 登入，送審日期放20150101，隨便點一張單據內容
	* 測試 系統管理人： 361027 登入
	* OMD PIC  ：SELECT EMP_ID FROM AUT_MANAGER_DATA

	* EMAIL
         - SUBJECT: 審核人 - $目前使用者姓名$ 異動單據 $目前單據號碼$ 通知
         - BODY:
          	* 申請單號
          	* 申請品項
          	* 品項~審核數量(前五欄)
         - DESTINATION: $審請人EMAIL$
	* 再提醒一下，申請人用我的id-854180取代，到AD SERVER找E-MAIL後寄給我就好
(1) ADClass.QueryADMail(strADPath, APPLY_EMP_ID)
(2) MyMail.Send is not working


場站主管審核後，若申請資料遭OMD PIC或系統管理人修改，由系統傳送異動通知給申請人 
## 2015-06-22 (MON)
  - 修正 BASD0021.aspx.cs 在存檔之前先檢驗欄位是否超過特定長度
  - 修正 BCRD0022.js 在存檔之前, 會自動新增一筆資料的問題, 導致新增前驗證"標準量加總=總數量"失敗 

## 2015-06-18 (THU)
  - 修正 BASD0021.aspx.cs 錯誤 (BAS_MATERIAL資料表無對應欄位 CHINESE_SPEC_DESC, ENGLISH_SPEC_DESC)
  - PURD0024.aspx 發送email內容錯誤
	* SELECT * FROM BAS_REFERENCE_DATA_DETAILS WHERE CONFIG_TYPE= 'EMAIL_PO'
	* BLL_PURD0020.cs (lineNo: 834)

[x]
鄭智方
長榮航空股份有限公司
服務品本部 物品採購部 物品採購課
33801桃園縣蘆竹鄉新南路一段376號8樓
Tel : +886-3-351-5939 Fax: +886-3-351-0017
E-mail : veronicacheng@evaair.com

Veronica Cheng
Procurement Sec.Procurement Dept., Cabin Service Div
EVA Airways Corp.
8th FL., 376, Hsin-Nan Rd., Sec. 1, Luchu, Taoyuan Hsien, 338, Taiwan
Tel : +886-3-351-5939 Fax: +886-3-351-0017
E-mail : veronicacheng@evaair.com

[O]
鄭智方
長榮航空股份有限公司
客艙服務本部 商品行銷部 商品採購課
33801桃園縣蘆竹鄉新南路一段376號二訓大樓9樓
Tel : +886-3-351-5939 Fax: +886-3-351-0017
E-mail : veronicacheng@evaair.com

英文版如下：

Veronica Cheng
Product Procurement Sec. Product Marketing Dept., Cabin Service Div
EVA Airways Corp.
9th FL. 2nd Training Building, 376, Hsin-Nan Rd., Sec. 1, Luchu, 
Taoyuan Hsien, 338, Taiwan
Tel : +886-3-351-5939 Fax: +886-3-351-0017
E-mail : veronicacheng@evaair.com

  - 撰寫報表 SCRR0160
	* 測試資料(190001 OR 200911)
	* 由於要顯示圖片, 因此另外開一個TABLE (SCR_RPT_TMP_1), 儲存報表資料
```
CREATE TABLE UATTEST.SCR_RPT_TMP_1
(
  SEQ       VARCHAR2(10 BYTE),
  C1        VARCHAR2(60 BYTE),
  C2        VARCHAR2(60 BYTE),
  C3        VARCHAR2(60 BYTE),
  C4        VARCHAR2(60 BYTE),
  C5        VARCHAR2(60 BYTE),
  C6        VARCHAR2(60 BYTE),
  C7        VARCHAR2(60 BYTE),
  C8        VARCHAR2(60 BYTE),
  C9        VARCHAR2(60 BYTE),
  C10       VARCHAR2(60 BYTE),
  C11       VARCHAR2(60 BYTE),
  C12       VARCHAR2(60 BYTE),
  C13       VARCHAR2(60 BYTE),
  C14       VARCHAR2(60 BYTE),
  C15       VARCHAR2(60 BYTE),
  C16       VARCHAR2(60 BYTE),
  C17       VARCHAR2(60 BYTE),
  C18       VARCHAR2(60 BYTE),
  C19       VARCHAR2(60 BYTE),
  C20       VARCHAR2(60 BYTE),
  C21       VARCHAR2(60 BYTE),
  C22       VARCHAR2(60 BYTE),
  C23       VARCHAR2(60 BYTE),
  C24       VARCHAR2(60 BYTE),
  C25       VARCHAR2(60 BYTE),
  C26       VARCHAR2(60 BYTE),
  C27       VARCHAR2(60 BYTE),
  C28       VARCHAR2(60 BYTE),
  C29       VARCHAR2(60 BYTE),
  C30       VARCHAR2(60 BYTE),
  C31       VARCHAR2(60 BYTE),
  C32       VARCHAR2(60 BYTE),
  C33       VARCHAR2(60 BYTE),
  C34       VARCHAR2(60 BYTE),
  C35       VARCHAR2(60 BYTE),
  C36       VARCHAR2(60 BYTE),
  C37       VARCHAR2(60 BYTE),
  C38       VARCHAR2(60 BYTE),
  C39       VARCHAR2(60 BYTE),
  C40       VARCHAR2(60 BYTE),
  C41       VARCHAR2(60 BYTE),
  C42       VARCHAR2(60 BYTE),
  C43       VARCHAR2(60 BYTE),
  C44       VARCHAR2(60 BYTE),
  C45       VARCHAR2(500 BYTE),
  C46       VARCHAR2(500 BYTE),
  C47       VARCHAR2(4000 BYTE),
  C48       VARCHAR2(200 BYTE),
  C49       VARCHAR2(300 BYTE),
  C50       VARCHAR2(200 BYTE),
  C51       BLOB,
  C52       BLOB,
  C53       BLOB,
  C54       BLOB,
  N1        NUMBER(10),
  N2        NUMBER(10),
  N3        NUMBER(10),
  N4        NUMBER(10),
  N5        NUMBER(10),
  N6        NUMBER(10),
  N7        NUMBER(10),
  N8        NUMBER(10),
  N9        NUMBER(10),
  N10       NUMBER(10),
  N11       NUMBER(10),
  N12       NUMBER(10),
  N13       NUMBER(10),
  N14       NUMBER(10),
  N15       NUMBER(10),
  N16       NUMBER(10),
  N17       NUMBER(10),
  N18       NUMBER(10),
  N19       NUMBER(10),
  N20       NUMBER(10),
  N21       NUMBER(10),
  N22       NUMBER(10),
  N23       NUMBER(10),
  N24       NUMBER(10),
  N25       NUMBER(10),
  N26       NUMBER(10),
  N27       NUMBER(10),
  N28       NUMBER(10),
  N29       NUMBER(10),
  N30       NUMBER(10),
  N31       NUMBER(10),
  N32       NUMBER(10),
  N33       NUMBER(10),
  N34       NUMBER(10),
  N35       NUMBER(10),
  N36       NUMBER(10),
  N37       NUMBER(10),
  N38       NUMBER(10),
  N39       NUMBER(10),
  N40       NUMBER(10),
  N41       NUMBER(15,5),
  N42       NUMBER(15,5),
  N43       NUMBER(15,5),
  N44       NUMBER(15,5),
  N45       NUMBER(15,5),
  N46       NUMBER(15,5),
  N47       NUMBER(15,5),
  N48       NUMBER(15,5),
  N49       NUMBER(15,5),
  N50       NUMBER(15,5),
  CRT_DATE  VARCHAR2(8 BYTE)                    DEFAULT TO_CHAR(SYSDATE,'YYYYMMDD'),
  CRT_TIME  VARCHAR2(6 BYTE)                    DEFAULT TO_CHAR(SYSDATE,'HH24MMSS')
)
```
## 2015-06-17 (WED)
  - 撰寫報表 SCRR0160X
	
## 2015-06-16 (TUE)
  - 修正 BASD0023.aspx
	 
Only JPG file formate accepted .
http://www.codeproject.com/Questions/708851/How-to-store-images-and-displaying-images-in-cryst
http://forums.asp.net/t/1896748.aspx?Displaying+images+BLOB+Mysql+data+in+Crystal+Report+
http://forums.asp.net/t/1724447.aspx?Unable+to+show+image+on+Crystal+Report

 public string[] SCRR0160(string SEQ, string PERIOD, string CLASS, string PRINTDATE, string HOUR, string MIN)

## 2015-06-15 (MON)
  - 機型總數量維護作業針對失效版本進行複製，複製內容的有效期限須為9991231(BCRD0011.aspx)
  - TCMS系統( 361027 / 1234 )
	* TCMSBL.vb, <del>主檔中航班資訊，新增B7航班資訊</del>
  - 機上免稅品新品圖 (SCRR0160)
	* 功能: [預覽列印], [批次列印], [清除]
	* 查詢欄位(1/2):年月(必填欄位)
	* 查詢欄位(2/2):商品主類別(下拉選單, 預設為全部)  
	  ```
	  SELECT * FROM BAS_SUB_COMMON_TYPE WHERE CODE_TYPE='SC';
	  ```
	* 查詢邏輯({料號, 中文品名, 英文品名, 圖} = {CODE, NAME_CHINESE, NAME_ENGLISH, IMAGE}) 
	  ```
	  SELECT * FROM PRE_PREORDER_MATERIAL WHERE CODE IN 
	  (
	  SELECT 
	      DISTINCT CODE 
	  FROM 
	      BAS_MATERIAL 
	  WHERE 
	      REQUEST_DATE BETWEEN '19000101' AND '19000131'
	      AND CLASS = 'W'
	  )
	  ```
	* 四筆資料一頁

## 2015-06-12 (FRI)
  - TCMS系統( 361027 / 1234 )
	* TCMSBL.vb, <del>主檔中航班資訊，新增B7航班資訊</del>

## 2015-06-11 (THU)
  - TCMS系統( 361027 / 1234 )
	* B2ED011, <del>系統管理人審核申請單時，先提示庫存量及單位，超出庫存量者無法審核，必須修改審核數量</del>

## 2015-06-10 (WED)
  - TCMS系統( 361027 / 1234 )
	* 主檔中航班資訊，新增B7航班資訊 
	* 系統管理人審核申請單時，先提示庫存量及單位，超出庫存量者無法審核，必須修改審核數量
	* B2E3B, <del>運補單產生時，資料依場站別印出</del>
	* INVD060, <del>查詢表單資料時，不需列出已下架版本，僅列出最新版本</del>

  <dataBase id="FIS">
    <DBType>Oracle</DBType>
    <DBServer>FIS.evaair.com</DBServer>
    <DBName>FIS.evaair.com</DBName>
    <ID>AAFS_SMAS</ID>
    <Password>SMAS_FIS0301</Password>
    <ConnectionTimeOut>1</ConnectionTimeOut>
  </dataBase>
  <dataBase id="TCMS">
    <DBType>Oracle</DBType>
    <DBServer>TCMSTEST.evaair.com</DBServer>
    <DBName>TCMS</DBName>
    <ID>TCMSTEST</ID>
    <Password>p35TCMST082</Password>
    <ConnectionTimeOut>1</ConnectionTimeOut>
  </dataBase>
  <dataBase id="TCMS">
    <DBType>Oracle</DBType>
    <DBServer>TCMS.evaair.com</DBServer>
    <DBName>TCMS</DBName>
    <ID>TCMS</ID>
    <Password>p35TCMS03</Password>
    <ConnectionTimeOut>1</ConnectionTimeOut>
  </dataBase>

## 2015-06-09 (TUE)
  - fortify (SMAS.MainWebAP.UNI)
  - 除錯(PSNF020\NIGHTRUN.cs)並未將物件參考設定為物件的執行個體

## 2015-06-08 (MON)
  - fortify (SMAS.MainWebAP.UNI)
  - 除錯(PSNF020\NIGHTRUN.cs)並未將物件參考設定為物件的執行個體
  - PURR020 (C:\Inetpub\wwwroot\TCMS\PUR\Report), <del>採購管理流程中，訂購單版本不正確，需修改成最新版序</del>

## 2015-06-05 (FRI)
  - fortify (SMAS.MainWebAP.UNI)
  - 查詢以下問題發生原因，AUTD0080在執行駁回申請時，更新 H_ONWAY_QTY 有問題
  - 模擬情境 
	* 以 399468 登入 --> INVD0020 --> 新增 --> MANO 到 KHHO --> 4800755 36個，送審,產生H150003579
	* 以 187560 登入 --> AUTD0080 --> 擬准
	* 以 E70465 登入 --> AUTD0080 --> 駁回
Procedure.cs
lineNo: 4312
```
SELECT 
	ROWID, B.* 
FROM 
	INV_EXPIRE_MATERIAL_STOCK B
WHERE 
	STORE_NO='KHHO'
	AND CODE='4800755'
	AND QTY<>0;
```

## 2015-06-04 (THU)
  - fortify

## 2015-06-03 (WED)
  - 設定本機資料夾( C:\inetpub\wwwroot\SMAS.MainWebAP\SMAS.MainWebAP.BAS\TEMP )
	* 建立資料夾 C:\inetpub\wwwroot\SMAS.MainWebAP\SMAS.MainWebAP.BAS\TEMP
	* 給予以下使用者此資料夾的所有權限
	  (1) NETWORK SERVICE
   
 - 設定遠端資料夾( \\Smasap03.evaair.com\smas\Sound\BAS\Material\ )
	* 登入到伺服器 SMASAP03
	* 建立資料夾 C:\SMAS\Sound\BAS\Material (SELECT SERVER_PATH FROM BAS_DATA_INTERFACE WHERE INTERFACE_ID = 'BASD0020_S')
	* 給予以下使用者此資料夾的所有權限
	  (1) 選擇一個DOMAIN USER(e.g. evaair/e10760)，此DOMAIN USER就是登入QASMASAP01的使用者
	  (2) 將給予此使用者資料夾所有權縣 

 - 使用FortifyUtils.PathCombine會出問題
	//string filePath = FortifyUtils.PathCombine(dir, string.Format("{0}{1}", SERIAL_NO, Path.GetExtension(htmlInputFile.PostedFile.FileName)));
	//filePath = "\\" + filePath;
	
	string filePath = Path.Combine(dir, string.Format("{0}{1}", SERIAL_NO, Path.GetExtension(htmlInputFile.PostedFile.FileName)));
	return filePath;

http://blog.miniasp.com/post/2007/11/10/How-to-write-file-to-net-share-folder-using-ASPNET.aspx
http://www.outsystems.com/forums/discussion/5653/how-to-setting-up-applications-access-to-file-systems/
https://msdn.microsoft.com/en-us/library/cc515176%28v=cs.70%29.aspx


## 2015-06-02 (TUE)
  - 修正Fortify Issue
	* APN
	* AUT(尚未解決)
	* B2C(尚未解決)
	* BAS
	* BCR
	* BUD
	* CAT
	* CRW(尚未解決)
	* CTM
	* INV
	* LCS(尚未解決)
	* NSP
	* OUT
	* PSD


## 2015-06-02 (MON)
  - 修正在PURD0040在產製報表INVR0140R, PURR0060R的問題

SELECT 
    ORIGINAL_TRANS_NO,
    (SELECT DISTINCT REQUEST_NO FROM PUR_PURCHASE_DETAILS WHERE PURCHASE_NO=ORIGINAL_TRANS_NO),
    (SELECT VENDOR_NO FROM PUR_PURCHASE_MASTER WHERE PURCHASE_NO=ORIGINAL_TRANS_NO),
    (SELECT VENDOR_NAME_ENGLISH FROM VND_VENDOR WHERE VENDOR_NO = (SELECT VENDOR_NO FROM PUR_PURCHASE_MASTER WHERE PURCHASE_NO=ORIGINAL_TRANS_NO))
FROM
    INV_TRANS_DETAILS
WHERE    
    TRANS_NO='J150000033' 
ORDER BY  ORIGINAL_TRANS_NO  

## 2015-05-29 (FRI)
  - 修正在QASMASWBS04執行Jobs會失敗的問題
  - 建立JobRecorder

INVR0140報表前四項要各自獨立成一行
抓資料的方式還要再問泰尉

流程
PURD0040 -> 20150522 ~ 20150529
SELECT ONE ROW (申請單序號　5006)
PRESS '相關訂購單...'
PRESS '批次列印'

檢視報表
PURR0060R
INVR0140R

INVR0140_1

## 2015-05-28 (THU)
  - 修正在QASMASWBS04執行Jobs會失敗的問題
	* 確保相關資料庫連線參數有設定在 C:\dbconfig.xml
	* 確保相關資料庫連線參數有設定在 tnsname.ora
	* 建立資料夾 "C:\com.ddsc.database"，並給予目前使用者有足夠權限存取此資料夾
  
## 2015-05-27 (WED)
  - BASD0023加入下載功能
  - 轉檔(將 PSN_OPEN_DATA_NEW 從 WP32.evaair.com 寫入 SMASTEST.evaair.com)
	* 工作環境 : QASMASWBS04 (帳號密碼 : E70964/19910103)
	* 請在 QASMASWBS04 另開專案
	* SMASTEST.evaair.com (scs/p35scs2015)
	* WP32.evaair.com (SMAS_LINK/CPU)
	* dbCONFIG:
```
<dataBase id="WP32" EventLog="false" EventLogPath="C:\com.ddsc.database">
	<dbType>ORACLE</dbType> 
	<dbServer>WP32.evaair.com</dbServer> 
	<userID>HordAK8TsYM9lXFV6GIZ+a5qm4HJWnvFUPzKnBhgz/4=</userID> 
	<userPW>EOLTLkpFBsf0TpokzRHOEu0YR6zhTWvsnyqHsb54WtI=</userPW> 
	<connectionTimeOut>100000</connectionTimeOut> 
</dataBase>
```
 
## 2015-05-26 (TUE)
  - 處理 OUTR0030 預覽報表問題  
    請幫忙看看一樣的報表，都是跑AA 料庫，為何數字會不同?? 謝謝!  
	http://localhost/SMASWebAP/OUT/OUTR0030.aspx

 
轉檔來源
WP32.evaair.com  
SMAS_LINK/CPU  
轉檔目的
SMARTTEST.evaair.com

QueryCondition 1
料號 0100001 ~ 4999999 
年月 201404  ~ 201503

料號 1100379 
年月 201404 201503

E70964/19910102

QueryCondition 2
料號 1100379 
年月 201405 201504

## 2015-05-25 (MON)
  - (BASD0023) 解決 Fortify Issue
 
## 2015-05-22 (FRI)

  - 測試帳號:395408
  - TASK01: BASD0021加入兩個欄位(中文特色介紹，英文特色介紹)
  - TASK02: 新增上傳聲音檔(BASD0023)頁面
	* 聲音檔允許上傳檔案類型(WAV,WMV,MP3)
	* 可以線上播放

  CHINESE_SPEC_DESC    VARCHAR2(100 BYTE),
  ENGLISH_SPEC_DESC    VARCHAR2(100 BYTE)

(1)
  <data name="BTNSOUND" xml:space="preserve">
    <value>聲音資料</value>
  </data>  
  <data name="SOUNDPATH" xml:space="preserve">
    <value>聲音檔案路徑</value>
  </data>
  <data name="CHINESE_SPEC_DESC" xml:space="preserve">
    <value>中文特色介紹</value>
  </data>
  <data name="ENGLISH_SPEC_DESC" xml:space="preserve">
    <value>英文特色介紹</value>
  </data>  

(2) 建立資料夾並授予權限
C:\inetpub\wwwroot\SMAS.MainWebAP\SMAS.MainWebAP.BAS\TEMP

(3) 專案參考需增加 NuGet: Sasa

gNewData += txtREMARK.Text.Trim() + "?"; //備註

BAS_MATERIAL_SOUND_SEQUENCE, BAS_MATERIAL_IMAGE_SEQUENCE 一模一樣 拷貝即可
抓取最新版本

## 2015-05-21 (THU)
  - 宣導維護(PSDM0090, PSDM0091) 解決 Fortify Issue 
  - 屬性: 海關庫存差異檢核
  - 

## 2015-05-20 (WED)
  - 偵錯料號(8402225, 8402235, 8402216) 在
  - 時與預期結果不一致的問題 	
  - 屬性: 海關庫存差異檢核
  - 

## 2015-05-19 (TUE)
  - 宣導維護(PSDM0090, PSDM0091)
  - 屬性: 海關庫存差異檢核轉檔

## 2015-05-18 (MON)
  - 宣導維護(PSDM0090, PSDM0091)
  - 屬性: 海關庫存差異檢核轉檔

## 2015-05-15 (THU)
  - 宣導維護(PSDM0090, PSDM0091)
  - 屬性: 海關庫存差異檢核轉檔
  
## 2015-05-14 (THU)
  - 宣導維護(PSDM0090, PSDM0091)
  - 屬性: 海關庫存差異檢核轉檔
  - TABLE: PSD_LED_PPT_ITEM
  - [解決
  - 失敗，拒絕存取路徑](http://name7946123.blogspot.tw/2013/07/blog-post_18.html)  
  - [使用PLUPLOAD進行多檔案上傳(前端)](http://www.plupload.com/docs/)  
  - [使用PLUPLOAD進行多檔案上傳(後端)](http://weblog.west-wind.com/posts/2013/Mar/12/Using-plUpload-to-upload-Files-with-ASPNET)
  - 專案參考需增加 NuGet: Westwind.Utilities, AntiXSS, Sasa
  - 上傳資料夾(TempUploads, Uploads)，針對IIS_IUSEr加入所有權限
  - [sasa source code](http://sourceforge.net/projects/)sasa/
 
## 2015-05-13 (WED)
  - CTMF020.CheckInconsistentStock
	* 工作屬性：海關帳
	* 新增 [庫存量 = 現有量 AND 庫存量 <> 海關庫存量]
	* 新增 [現有量 <> 海關庫存量]
  - CTMF020_TEMP.UpdateInconsistentStock
	* 工作屬性：海關帳
	* SET 海關庫存量 = 庫存量 IF 現有量 = 庫存量一樣 AND 庫存量 <> 海關庫存量

## 2015-05-12 (TUE)
  - 修正INVR0020最新庫存表卻跑不出
	* 頁面  
	  http://localhost/SMASWebAP/INV/INVR0020.aspx
	* 查詢條件
		1. 料庫: 
		2. GENL
		2. 料號1: 6200960 ~ 6200970
	* 對應查詢邏輯    
	  \\C136244\shared\20150512_INVR0020_GENL_6200960_6200970.SQL
	* 結論  
	  無任何問題

  - 忘記哪一功能頁，但以下邏輯有問題
  -   
```
if (string.IsNullOrEmpty(Request["From"].ToString().Trim()) & string.IsNullOrEmpty(Request["To"].ToString().Trim()))  
else if (!string.IsNullOrEmpty(Request["From"].ToString().Trim()) & !string.IsNullOrEmpty(Request["To"].ToString().Trim()))  
```	  



## 2015-05-11 (MON)

  - 修正INVR0020在預覽列印時，發生異常的問題
	* 頁面  
	  http://localhost/SMASWebAP/INV/INVR0020.aspx
	* 查詢條件
		1. 料庫: MANO
		2. 料號1: 4000001 ~ 4999999  
	* 錯誤訊息(英文)  
	  The given DataRow is not in the current DataRowCollection
	* 發生例外問題點  
	  ReportLogic_INV.INVR0020,  ds_P1.Tables[1].Rows.Remove(row); // 清除原本的資料
	* 解決方法  
	  if (!original_rows.Contains(dr)) // 原本只有 'original_rows.Add(dr);'，加上這一行避免重複加入 dr

  - 修正INVR0300，2015/03月的當月進貨金額，沒有資料。
	* 頁面  
	  http://localhost/SMASWebAP/INV/INVR0300.aspx
	* 查詢條件  
	  201503
	* 對應查詢邏輯    
	  \\LOCALHOST\shared\INVR0300_201503.sql
	* 錯誤原因  
	  INV_STOCK_AVG_AMT在201503月份沒有資料
	* 搜尋會塞入INV_STOCK_AVG_AMT資料表的JOB，手動執行對應動作(參數為201503)

## 2015-05-08 (FRI)

  - 新增PSDM0070, PSDM0071

## 2015-05-07 (THU)

  - 新增PSDM0080, PSDM0081
		
## 2015-05-06 (WED)

  - 修正PSDM0021星期欄位，對應儲存到資料庫的欄位格式
  - 航行管制部作業手冊
	* PSDM0070
	* PSDM0071
	* PSDM0080
	* PSDM0081
	
	* task_1 2015-05-05 (TUE) 
	* task_1 2015-04-30 (THU)
	* task_1 2015-04-29 (WED)
	* task_1 2015-04-21 (TUE)

	* task_2 2015-05-04 (MON)
	* task_2 2015-04-22 (WED)
	* task_2 2015-04-20 (MON)
	* task_2 2015-04-17 (FRI)

	* task_3 2015-04-15 (WED)
	* task_3 2015-04-14 (TUE)
	* task_3 2015-04-13 (MON)
	* task_3 2015-04-10 (FRI)

	* task_4 2015-04-28 (TUE)
	* task_4 2015-04-27 (MON)
	* task_4 2015-04-24 (FRI)
	* task_4 2015-04-23 (THU)
	
## 2015-05-05 (TUE)

  - 修正PSDM0021星期欄位，對應儲存到資料庫的欄位格式
  - 航行管制部作業手冊
	* PSDM0070
	* PSDM0071
	* PSDM0080
	* PSDM0081

  
## 2015-05-04 (MON)

  - 修正報表計算問題 
  - 
  
## 2015-04-30 (THU)

  - PURD0023新增以下欄位，並且修改對應UI

```
NEWS_WEEKDAYS  VARCHAR2(256 BYTE)             NOT NULL,  
NEWS_TIME1     VARCHAR2(8 BYTE)               NOT NULL,  
NEWS_TIME2     VARCHAR2(8 BYTE)               NOT NULL,	  								
NEWS_TARGETS   VARCHAR2(256 BYTE)             NOT NULL,  
NEWS_IMGNAME   VARCHAR2(256 BYTE)             NOT NULL,  
NEWS_IMGPATH   VARCHAR2(256 BYTE)             NOT NULL,  
```
 
## 2015-04-29 (WED)

  - 偵錯B2CR0140報表問題, 尋找ReportLogic_B2C.cs中，函式B2CR0140查詢SQL問題
 
## 2015-04-28 (TUE)

  - 轉檔 PSNF010

## 2015-04-27 (MON)

  - 修正PURD0021.aspx，處理儲存按鈕後，訂單在途量的數目不正確的問題
 
## 2015-04-24 (FRI)

  - 修正PURD0021.aspx，處理在執行取消訂單後，訂單在途量的數目不正確的問題

## 2015-04-23 (THU)

  - 修正PURD0021.aspx，處理在執行取消訂單後，訂單在途量的數目不正確的問題
 
## 2015-04-22 (WED)

  - 修正OUTD0051.js，解決領用量的小數點問題(parseInt改成parseFloat)

## 2015-04-21 (TUE)

  - 修正WorkFlowRemark.aspx, 限制REMARK輸入不可大於200個字

## 2015-04-20 (MON)

  - 修正INVR0050.aspx查詢SQL邏輯(INVD0150.Query)
  
## 2015-04-17 (FRI)

  - 修正INVR0050.aspx查詢SQL邏輯(INVD0150.Query)

## 2015-04-16 (THU)

  - 請假看病

## 2015-04-15 (WED)

  - 修正INVR0050.aspx查詢SQL邏輯(INVD0150.Query)

## 2015-04-14 (TUE)

  - 處理轉檔(CTMF020.CheckStock)  
	EMAIL伺服器    
	const string SMTP = "10.3.25.150";  //測試完，要關掉

## 2015-04-13 (MON)

  - 修正fortity偵測到的XSS問題(B2CM0081.aspx.cs, B2CM0081.js)  
	前端：$.param  
	後端：Server.Encode

## 2015-04-10 (FRI)

  - 修正報表(BCRR0040R.rpt)，不能夠分頁的問題


https://evaflow.evaair.com/djps/